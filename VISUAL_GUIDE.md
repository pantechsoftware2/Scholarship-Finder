# ğŸ“Š VISUAL GUIDE - Lead Submission Flow

## Before Fix: âŒ Data Not Saving
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER FRONTEND                         â”‚
â”‚                                                           â”‚
â”‚  1. Enter scholarship search info                        â”‚
â”‚     â””â”€â†’ Click "Calculate Scholarships"                  â”‚
â”‚         â†“                                                â”‚
â”‚  2. See results                                          â”‚
â”‚     â””â”€â†’ Click "Unlock Full List"                        â”‚
â”‚         â†“                                                â”‚
â”‚  3. Fill: Name, Email, Phone                            â”‚
â”‚     â””â”€â†’ Click "Submit"                                  â”‚
â”‚         â†“                                                â”‚
â”‚  âœ… Show: "Lead submitted successfully!"                â”‚
â”‚         â†“                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  VERCEL BACKEND API                      â”‚
â”‚                                                           â”‚
â”‚  POST /api/submit-lead                                  â”‚
â”‚         â†“                                                â”‚
â”‚  sheets_service.py                                      â”‚
â”‚         â†“                                                â”‚
â”‚  Read: GOOGLE_APPS_SCRIPT_URL                           â”‚
â”‚  Status: âŒ UNDEFINED (not in Vercel env vars)          â”‚
â”‚         â†“                                                â”‚
â”‚  âŒ API call fails silently                             â”‚
â”‚         â†“                                                â”‚
â”‚  âŒ No error shown to user                              â”‚
â”‚         â†“                                                â”‚
â”‚  âœ… Return success anyway (misleading!)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GOOGLE SHEETS (The Database)                â”‚
â”‚                                                           â”‚
â”‚  âŒ NO DATA APPEARS                                      â”‚
â”‚  âŒ User confused: "Where is my data?"                  â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULT: User sees âœ… but data is âŒ
```

---

## After Fix: âœ… Data Saving Correctly
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER FRONTEND                         â”‚
â”‚                                                           â”‚
â”‚  1. Enter scholarship search info                        â”‚
â”‚     â””â”€â†’ Click "Calculate Scholarships"                  â”‚
â”‚         â†“                                                â”‚
â”‚  2. See results                                          â”‚
â”‚     â””â”€â†’ Click "Unlock Full List"                        â”‚
â”‚         â†“                                                â”‚
â”‚  3. Fill: Name, Email, Phone                            â”‚
â”‚     â””â”€â†’ Click "Submit"                                  â”‚
â”‚         â†“                                                â”‚
â”‚  âœ… Show: "Lead submitted successfully!"                â”‚
â”‚         â†“                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  VERCEL BACKEND API                      â”‚
â”‚                                                           â”‚
â”‚  POST /api/submit-lead                                  â”‚
â”‚         â†“                                                â”‚
â”‚  sheets_service.py                                      â”‚
â”‚         â†“                                                â”‚
â”‚  âœ… Check: GOOGLE_APPS_SCRIPT_URL                       â”‚
â”‚  Status: âœ… SET in Vercel environment                   â”‚
â”‚         â†“                                                â”‚
â”‚  âœ… Prepare lead data                                   â”‚
â”‚         â†“                                                â”‚
â”‚  âœ… Call Google Apps Script API                         â”‚
â”‚         â†“                                                â”‚
â”‚  â”Œâ”€ Try API Call                                        â”‚
â”‚  â”‚   â”œâ”€ Success? â†’ Save to Sheets âœ…                    â”‚
â”‚  â”‚   â”œâ”€ Timeout? â†’ Save to JSON backup                  â”‚
â”‚  â”‚   â”œâ”€ Network error? â†’ Save to JSON backup            â”‚
â”‚  â”‚   â””â”€ Any error? â†’ Save to JSON backup                â”‚
â”‚  â”‚                                                       â”‚
â”‚  â””â”€ Always â†’ Save locally in JSON                       â”‚
â”‚         â†“                                                â”‚
â”‚  ğŸ“Š Log: "âœ… Lead successfully saved to Google Sheets"   â”‚
â”‚         â†“                                                â”‚
â”‚  ğŸ“§ Send confirmation email                             â”‚
â”‚         â†“                                                â”‚
â”‚  âœ… Return success                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GOOGLE SHEETS (The Database)                â”‚
â”‚                                                           â”‚
â”‚  âœ… NEW ROW APPEARS:                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Name   â”‚ Email              â”‚ Phone              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ John   â”‚ john@example.com   â”‚ +1-234-567-8900   â”‚ â”‚
â”‚  â”‚ Sarah  â”‚ sarah@example.com  â”‚ +1-234-567-8901   â”‚ â”‚
â”‚  â”‚ Mike   â”‚ mike@example.com   â”‚ +1-234-567-8902   â”‚ â”‚
â”‚  â”‚ NEW -> â”‚ new@example.com    â”‚ +1-234-567-8903   â”‚ â”‚ âœ…
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                           â”‚
â”‚  âœ… User sees data in their sheet!                      â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              JSON BACKUP (Optional)                      â”‚
â”‚                                                           â”‚
â”‚  ğŸ“ backend/app/data/leads.json                          â”‚
â”‚                                                           â”‚
â”‚  {                                                       â”‚
â”‚    "name": "new user",                                  â”‚
â”‚    "email": "new@example.com",                          â”‚
â”‚    "phone": "+1-234-567-8903",                          â”‚
â”‚    "timestamp": "2026-01-08 10:30:15",                  â”‚
â”‚    "scholarships": [...]                                â”‚
â”‚  }                                                       â”‚
â”‚                                                           â”‚
â”‚  âœ… Zero data loss if Sheets fails                      â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RESULT: User sees âœ… AND data is âœ…
```

---

## ğŸ”„ Error Handling Flow

```
         â†“
    Try to Call
    Apps Script
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Did it work?         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚           â”‚
   YES         NO
    â”‚           â”‚
    â†“           â†“
  SUCCESS    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        â”‚ What was the error? â”‚
    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚
    â”‚        â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        â”‚    â”‚         â”‚              â”‚
    â”‚      HTTP  TIMEOUT  NETWORK  OTHER
    â”‚       ERR             ERROR
    â”‚        â”‚    â”‚         â”‚              â”‚
    â”‚        â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚
    â”‚             â†“
    â”‚        Log Error + Details
    â”‚        Reason in logs
    â”‚        Error type clear
    â”‚
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Save to JSON Backup   â”‚
    â”‚  (Always happens)      â”‚
    â”‚  âœ… Zero data loss     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    âœ… Return success
         â†“
    Frontend shows message
         â†“
    Google Sheets: Data saved âœ…
    JSON Backup: Data saved âœ…
    Email: Sent âœ…
```

---

## Environment Variables Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer Machine       â”‚
â”‚                          â”‚
â”‚  .env file              â”‚
â”‚  â”œâ”€ GOOGLE_APPS...  âœ…  â”‚
â”‚  â”œâ”€ GOOGLE_API...   âœ…  â”‚
â”‚  â”œâ”€ SMTP_USER       âœ…  â”‚
â”‚  â””â”€ ...             âœ…  â”‚
â”‚                          â”‚
â”‚  python-dotenv loads themâ”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         (works locally)

              â†“
              â†“  Deploy to Vercel
              â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel Cloud            â”‚
â”‚                          â”‚
â”‚  .env file: âŒ IGNORED   â”‚
â”‚  (Git-ignored file)      â”‚
â”‚                          â”‚
â”‚  Environment Variables:  â”‚
â”‚  Dashboard config        â”‚
â”‚                          â”‚
â”‚  Vercel dashboard must   â”‚
â”‚  have them manually set  â”‚
â”‚                          â”‚
â”‚  Without them:           â”‚
â”‚  âŒ GOOGLE_APPS... = undefined
â”‚  âŒ GOOGLE_API... = undefined  â”‚
â”‚  âŒ SMTP_USER = undefined
â”‚  â””â”€ ... = undefined     â”‚
â”‚                          â”‚
â”‚  With them:             â”‚
â”‚  âœ… GOOGLE_APPS... = value
â”‚  âœ… GOOGLE_API... = value
â”‚  âœ… SMTP_USER = value
â”‚  â””â”€ ... = value         â”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       (needs manual setup)
```

---

## Setup Diagram: 3 Steps

```
STEP 1: ADD ENV VARS (2 min)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  https://vercel.com                â”‚
â”‚  â””â”€ Backend Project Settings       â”‚
â”‚     â””â”€ Environment Variables       â”‚
â”‚        â”œâ”€ Add: GOOGLE_APPS_SCRIPT... â”‚
â”‚        â”œâ”€ Add: GOOGLE_API_KEY      â”‚
â”‚        â”œâ”€ Add: SMTP_USER           â”‚
â”‚        â”œâ”€ ... (9 total)            â”‚
â”‚        â””â”€ âœ… DONE                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“

STEP 2: REDEPLOY (1 min)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Terminal:                         â”‚
â”‚  $ cd backend                      â”‚
â”‚  $ vercel --prod                   â”‚
â”‚                                    â”‚
â”‚  Wait for green checkmark âœ…       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“

STEP 3: TEST (2 min)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Go to frontend website         â”‚
â”‚  2. Search scholarships            â”‚
â”‚  3. Submit lead form               â”‚
â”‚  4. Check Google Sheet             â”‚
â”‚  5. See new row with data âœ…       â”‚
â”‚  6. Receive email âœ…               â”‚
â”‚  7. Check Vercel logs for âœ…       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
           DONE! ğŸ‰
```

---

## Debugging Flow

```
Is data NOT appearing?
         â”‚
         â”œâ”€ Check Vercel env vars set?
         â”‚  â””â”€ No? â†’ Add them in dashboard
         â”‚  â””â”€ Yes? â†’ Next
         â”‚
         â”œâ”€ Check backend redeployed?
         â”‚  â””â”€ No? â†’ Run vercel --prod
         â”‚  â””â”€ Yes? â†’ Next
         â”‚
         â”œâ”€ Check Vercel Runtime Logs
         â”‚  â””â”€ Shows error? â†’ Fix the error
         â”‚  â””â”€ Shows âœ…? â†’ Check Google Sheet
         â”‚
         â”œâ”€ Check Google Sheet
         â”‚  â””â”€ No new row? â†’ Check permissions
         â”‚  â””â”€ Row appears? â†’ Works! âœ…
         â”‚
         â””â”€ Still not working? â†’ Check DEPLOYMENT_CHECKLIST.md
```

---

**Visual Guide Complete** âœ…
All components shown with proper flow and error handling.
